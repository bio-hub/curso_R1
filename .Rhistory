group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
View()
View(bairros_recife)
View(cep_ruas)
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) |> View()
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
View()
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
View()
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
View()
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry,
fill = "#D5E2E8"),
linewidth = 0.025,
color = "#D5E2E8") +
# geom_sf(aes(geometry = geometry,
#               fill = "#D5E2E8"),
#           linewidth = 0.025,
#           color = "#D5E2E8") +
coord_sf(crs = 4674, expand = FALSE) +
geom_point(aes(x = munResLon,
y = munResLat,
colour = "#C9384B")) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry,
fill = "#D5E2E8"),
linewidth = 0.025,
color = "#D5E2E8") +
# geom_sf(aes(geometry = geometry,
#               fill = "#D5E2E8"),
#           linewidth = 0.025,
#           color = "#D5E2E8") +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#D5E2E8") +
# geom_sf(aes(geometry = geometry,
#               fill = "#D5E2E8"),
#           linewidth = 0.025,
#           color = "#D5E2E8") +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
# geom_sf(aes(geometry = geometry,
#               fill = "#D5E2E8"),
#           linewidth = 0.025,
#           color = "#D5E2E8") +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
View()
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(aes(geometry = geometry),
fill = n_casos_bairro) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(data = .,
aes(geometry = geometry),
fill = n_casos_bairro) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(data = .,
aes(geometry = geometry),
fill = n_casos_bairro) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(aes(geometry = geometry,
fill = n_casos_bairro)) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro, geometry) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(aes(geometry = geometry,
fill = n_casos_bairro)) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife") +
theme_bw() +
theme(title=element_text(face='bold'))
dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro, geometry) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(aes(geometry = geometry,
fill = n_casos_bairro)) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife",
fill = "contagem de casos") +
theme_bw() +
theme(title=element_text(face='bold'))
fig1 = dengue_recife |>
group_by(ID_UNIDADE) |>
count() %>%
left_join(.,
cnes_2024 |>
distinct(CNES, .keep_all = TRUE) |>
select(CNES, COD_CEP, FANTASIA,
TPGESTAO, VINC_SUS, munResLat, munResLon),
join_by(ID_UNIDADE == CNES)) |>
mutate(COD_CEP = as.integer(COD_CEP)) %>%
left_join(.,
cep_ruas |>
mutate(cep = str_replace(cep, "-", "")) |>
mutate(cep = as.integer(cep)),
join_by(COD_CEP == cep)) |>
mutate(bairro = tolower(bairro)) %>%
left_join(.,
bairros_recife,
join_by(bairro == bairro)) |>
group_by(bairro, geometry) |>
summarise(n_casos_bairro = sum(n, na.rm = TRUE)) |>
drop_na(bairro) |>
ggplot() +
geom_sf(data = bairros_recife,
aes(geometry = geometry),
fill = "#D5E2E8",
linewidth = 0.025,
color = "#80A1BC") +
geom_sf(aes(geometry = geometry,
fill = n_casos_bairro)) +
coord_sf(crs = 4674, expand = FALSE) +
annotation_scale(location = "br") +
annotation_north_arrow(location = "tr",
style = north_arrow_fancy_orienteering) +
labs(title = "Bairros do Recife",
caption = "FONTE: Secretaria de Infraestrutura e Serviços Urbanos do Recife",
fill = "contagem de casos") +
theme_bw() +
theme(title=element_text(face='bold'))
ggsave(fig1,
filename = "./data_sus/SINAN/nao_upar/fig1.png",
width = 1920*5,
height = 1080*5,
dpi = 600,
units = "px")
save.image("C:/Users/ronal/Downloads/dengue_recife.RData")
load("C:/Users/ronal/OneDrive/Desktop/dengue_recife.RData")
glimpse(dengue_2024)
dengue_2024 |> group_by(DT_NOTIFIC) |> count() |> View()
save(dengue_2024, file = "./data_sus/SINAN/nao_upar/dengue_2024.RData")
gc()
library(tidyverse)
library(data.table)
library(janitor)
library(RSelenium)
library(netstat)
library(rvest)
library(sf)
library(ggspatial)
library(read.dbc)
library(microdatasus)
sih_2024  = fetch_datasus(year_start = 2024,
year_end = 2024,
month_start = 1,
month_end = 12,
information_system = "SIH-RD",
timeout = 3600)
sih_2024  = fetch_datasus(year_start = 2024,
year_end = 2024,
month_start = 1,
month_end = 12,
uf = "PE",
information_system = "SIH-RD",
timeout = 3600)
glimpse(sih_2024)
#codigo ibge recife: 2611606
sih_dengue_recife = sih |>
filter(UF_ZI == "260000"
& MUNIC_RES == "261160"
& MUNIC_MOV == "261160")
#codigo ibge recife: 2611606
sih_dengue_recife = sih_2024 |>
filter(UF_ZI == "260000"
& MUNIC_RES == "261160"
& MUNIC_MOV == "261160")
View(sih_dengue_recife)
load("C:/Users/ronal/OneDrive/Desktop/dengue_recife.RData")
save.image("C:/Users/ronal/OneDrive/Desktop/dengue_recife.RData")
library(read.dbc)
library(microdatasus)
library(tidyverse)
library(DBI)
library(RPostgres)
readRenviron(".env")
con = dbConnect(drv = RPostgres::Postgres(),
dbname="data_sus",
host = Sys.getenv("HOST_ADDRESS"),
port = 5432,
user = Sys.getenv("USER"),
password = Sys.getenv("PASSWORD"))
1+1
plot(1,1)
setwd("C:/Users/ronal/OneDrive/biohubsolutions/cursos/curso_R1")
